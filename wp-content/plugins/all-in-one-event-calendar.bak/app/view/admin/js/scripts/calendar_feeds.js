/**
 * @license RequireJS domReady 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/* =========================================================
	 * bootstrap-modal.js v2.2.2
	 * http://twitter.github.com/bootstrap/javascript.html#modals
	 * =========================================================
	 * Copyright 2012 Twitter, Inc.
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 * ========================================================= */

timely.define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t++)e[t](n)}function a(){var e=r;t&&e.length&&(r=[],u(e))}function f(){t||(t=!0,o&&clearInterval(o),a())}function c(e){return t?e(n):r.push(e),c}var e=typeof window!="undefined"&&window.document,t=!e,n=e?document:null,r=[],i,s,o;if(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),s=document.createElement("div");try{i=window.frameElement===null}catch(l){}s.doScroll&&i&&window.external&&(o=setInterval(function(){try{s.doScroll(),f()}catch(e){}},30))}(document.readyState==="complete"||document.readyState==="interactive")&&f()}return c.version="2.0.0",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),timely.define("external_libs/bootstrap_tab",["jquery"],function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}),timely.define("scripts/calendar_feeds/facebook/facebook_utility_functions",["jquery","ai1ec_config","external_libs/bootstrap_tab"],function(e,t){e.fn.shift=function(){var e=this.get(0);return this.splice(0,1),e};var n=function(t){t===null?e("ul.nav-tabs a:first").tab("show"):e("ul.nav-tabs a[href="+t+"]").tab("show")},r=function(t){var n=e(t),r=e("<input />",{type:"hidden",name:n.attr("name"),value:n.attr("value")});n.after(r),setTimeout(function(){e("#facebook input[type=submit]").prop("disabled",!0)},10),e("#facebook a.btn").unbind("click"),e("#facebook a.btn").click(function(e){e.preventDefault()})},i=function(n){var r=n.closest(".ai1ec-facebook-items");n.closest(".ai1ec-facebook-subscriber").remove();var i=e(".ai1ec-facebook-subscriber",r);e("> .row-fluid",r).each(function(){var n=e(this);n.html("");for(var s=0;s<2;s++){if(s===0&&i.length===0){n.remove();if(e("> .row-fluid",r).length===0){var o=e("<div />",{"class":"no_subscription",text:t.no_more_subscription});r.append(o)}return}var u=i.shift();n.append(u)}})};return{activate_saved_tab_on_page_load:n,block_all_submit_and_ajax:r,cancel_element_and_reorder_other:i}}),timely.define("libs/utils",["jquery"],function(e){var t=function(){return{is_float:function(e){return!isNaN(parseFloat(e))},is_valid_coordinate:function(e,t){var n=t?90:180;return this.is_float(e)&&Math.abs(e)<n},convert_comma_to_dot:function(e){return e.replace(",",".")},field_has_value:function(t){var n="#"+t,r=e(n),i=!1;return r.length===1&&(i=e.trim(r.val())!==""),i},make_alert:function(t,n,r){var i="";switch(n){case"error":i="alert alert-error";break;case"success":i="alert alert-success";break;default:i="alert"}var s=e("<div />",{"class":i,html:t});if(!r){var o=e("<a />",{"class":"close","data-dismiss":"alert",href:"#",text:"x"});s.prepend(o)}return s},get_ajax_url:function(){return typeof window.ajaxurl=="undefined"?"http://localhost/wordpress/wp-admin/admin-ajax.php":window.ajaxurl},isUrl:function(e){var t=/(http|https|webcal):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},isValidEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}}}();return t}),timely.define("scripts/calendar_feeds/facebook/facebook_ajax_handlers",["jquery","scripts/calendar_feeds/facebook/facebook_utility_functions","libs/utils"],function(e,t,n){var r=function(t){var r=".ai1ec-facebook-multiselect-container[data-type="+t.type+"] .ajax-loading";e(r).css("visibility","hidden");if(t.errors===!0){var i=n.make_alert(t.error_messages.join("<br/>"),"error");e("#alerts").append(i);return}e(" .ai1ec-facebook-multiselect-container[data-type="+t.type+"] .ai1ec-facebook-multiselect").replaceWith(t.html);var s=n.make_alert(t.message,"success");e("#alerts").append(s)},i=function(t){var r=".ai1ec-facebook-refresh[data-id="+t.id+"]";e(r).closest(".ai1ec-facebook-subscriber").find(".ajax-loading-user").hide();var i;if(t.exception!==undefined)i=n.make_alert(t.message,"error");else{var s=t.errors?"warning":"success";i=n.make_alert(t.message,s)}e("#alerts").append(i)},s=function(r){var i=".ai1ec-facebook-remove[data-id="+r.id+"]",s=e(i);s.closest(".ai1ec-facebook-subscriber").find(".ajax-loading-user").hide();var o;if(r.errors===!0)o=n.make_alert(r.error_message,"error");else{o=n.make_alert(r.message,"success");var u=r.logged==="true"?!0:!1;u?(e("#ai1ec_facebook_subscribe_yours").show(),s.closest("#ai1ec-facebook").find(".ai1ec-facebook-category-tag-wrapper").remove(),s.closest(".ai1ec-facebook-subscriber").find("a.btn").remove()):(t.cancel_element_and_reorder_other(s),e(".ai1ec-facebook-multiselect-container[data-type="+r.type+"] .ai1ec-facebook-multiselect").replaceWith(r.html))}e("#alerts").append(o)};return{handle_refresh_multiselect:r,handle_refresh_events:i,handle_remove_events:s}}),timely.define("external_libs/jquery_cookie",["jquery"],function(e){e.cookie=function(t,n,r){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||n===null||n===undefined)){r=e.extend({},r);if(n===null||n===undefined)r.expires=-1;if(typeof r.expires=="number"){var i=r.expires,s=r.expires=new Date;s.setDate(s.getDate()+i)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",r.raw?n:encodeURIComponent(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}r=n||{};var o=r.raw?function(e){return e}:decodeURIComponent,u=document.cookie.split("; ");for(var a=0,f;f=u[a]&&u[a].split("=");a++)if(o(f[0])===t)return o(f[1]||"");return null}}),timely.define("scripts/calendar_feeds/facebook/facebook_event_handlers",["jquery","ai1ec_config","scripts/calendar_feeds/facebook/facebook_utility_functions","scripts/calendar_feeds/facebook/facebook_ajax_handlers","libs/utils","external_libs/jquery_cookie"],function(e,t,n,r,i){var s=i.get_ajax_url(),o=function(t){var n=e(this).attr("href");e.cookie("feeds_active_tab",n)},u=function(r){var i=e("select.ai1ec-facebook-multiselect option:selected").length;if(i===0)return window.alert(t.select_one_option),!1;if(i>10)return window.alert(t.no_more_than_ten),!1;n.block_all_submit_and_ajax(this)},a=function(e){n.block_all_submit_and_ajax(this)},f=function(t){t.preventDefault(),e.ajaxSetup({timeout:24e5}),e(this).closest(".ai1ec-facebook-multiselect-title-wrapper").find(".ajax-loading").css("visibility","visible");var n=e(this).closest(".ai1ec-facebook-multiselect-container").data("type"),i={action:"ai1ec_refresh_facebook_objects",ai1ec_type:n};e.post(s,i,r.handle_refresh_multiselect,"json")},l=function(t){t.preventDefault();var n=e(this).closest(".ai1ec-facebook-items").data("type");e(this).closest(".ai1ec-facebook-subscriber").find(".ajax-loading-user").show();var i={action:"ai1ec_refresh_events",ai1ec_post_id:e(this).data("id"),ai1ec_type:n};e.post(s,i,r.handle_refresh_events,"json")},c=function(t){t.preventDefault();var n=e(this).closest(".ai1ec-facebook-subscriber").find(".ai1ec-facebook-name").text(),r=e(this).data("id");e("#ai1ec-facebook-modal #ai1ec-facebook-user-modal").text(n),e("#ai1ec-facebook-modal a.btn").data("user_id",r).data("el",this).data("logged",e(this).hasClass("logged")),e("#ai1ec-facebook-modal").modal({show:!0,backdrop:!0})},h=function(t){t.preventDefault(),e("#ai1ec-facebook-modal").modal("hide");var n=e(this).hasClass("remove")?!0:!1,i=e(this).data("el"),o=e(i).closest(".ai1ec-facebook-subscriber").find(".ajax-loading-user");o.show();var u=e(this).data("logged"),a=e(i).closest(".ai1ec-facebook-items").data("type"),f={action:"ai1ec_remove_subscribed",ai1ec_post_id:e(this).data("user_id"),ai1ec_remove_events:n,ai1ec_logged_user:u,type:a};e.post(s,f,r.handle_remove_events,"json")},p=function(t){e(this).attr("href")==="#"&&(t.preventDefault(),e("#ai1ec_facebook_connect_modal").modal({show:!0,backdrop:!0}))},d=function(n){var r=!0;e("#ai1ec_facebook_connect_modal input:text").each(function(){this.value===""&&(r=!1)});if(r===!0)e("#ai1ec_facebook_connect_modal").modal("hide"),e("#ai1ec_facebook_modal_submit").click();else{var s=i.make_alert(t.app_id_and_secret_are_required,"error");e("#ai1ec_facebook_connect_modal .modal-body").prepend(s)}};return{handle_set_tab_cookie:o,do_controls_before_subscribing:u,handle_click_on_submit_buttons:a,refresh_multiselect:f,refresh_events:l,remove_subscription:c,modal_remove_subscription:h,click_on_facebook_connect_button_opens_modal_if_app_id_and_secret_are_not_set:p,click_on_save_button_in_modal_trigger_submit:d}}),timely.define("scripts/calendar_feeds/ics/ics_utility_functions",["jquery"],function(e){var t=function(e){var t=e.closest(".ai1ec-feed-container");t.remove()},n=function(e){e.siblings(".ai1ec_delete_ics").removeAttr("disabled"),e.siblings(".ajax-loading").css("visibility","hidden")};return{remove_feed_from_dom:t,restore_normal_state_after_unsuccesful_delete:n}}),timely.define("scripts/calendar_feeds/ics/ics_ajax_handlers",["jquery","scripts/calendar_feeds/ics/ics_utility_functions","libs/utils"],function(e,t,n){var r=function(t){var n=e("#ai1ec_add_new_ics"),r=e("#ai1ec_feed_url");n.removeAttr("disabled"),t.error?window.alert(t.message):(r.val(""),e("#ai1ec-feeds-after").after(t.message))},i=function(r){var i=e("input[value="+r.ics_id+"]");r.error?t.restore_normal_state_after_unsuccesful_delete(i):t.remove_feed_from_dom(i);var s=r.error===!0?"error":"success",o=n.make_alert(r.message,s);e("#ics-alerts").append(o)},s=function(t){var r=e("input[value="+t.ics_id+"]"),i;t.error?i=n.make_alert(t.message,"error"):i=n.make_alert(t.message,"success"),e("#ics-alerts").append(i);var s=r.siblings(".ai1ec_update_ics");s.removeAttr("disabled").siblings(".ajax-loading").css("visibility","hidden")};return{handle_add_new_ics:r,handle_delete_ics:i,handle_update_ics:s}}),timely.define("scripts/calendar_feeds/ics/ics_event_handlers",["jquery","scripts/calendar_feeds/ics/ics_ajax_handlers","libs/utils","ai1ec_config"],function(e,t,n,r){var i=n.get_ajax_url(),s=function(s){var o=e(this),u=e("#ai1ec_feed_url"),a=u.val().replace("webcal://","http://"),f=!1,l;e(".ai1ec-feed-url, #ai1ec_feed_url").css("border-color","#DFDFDF"),e("#ai1ec-feed-error").remove(),e(".ai1ec-feed-url").each(function(){this.value===a&&(e(this).css("border-color","#FF0000"),f=!0,l=r.duplicate_feed_message)}),n.isUrl(a)||(f=!0,l=r.invalid_url_message);if(f)u.css("border-color","#FF0000").focus().before('<div class="error" id="ai1ec-feed-error"><p>'+l+"</p></div>");else{o.prop("disabled",!0);var c=e("#ai1ec_comments_enabled").is(":checked")?1:0,h=e("#ai1ec_map_display_enabled").is(":checked")?1:0,p={action:"ai1ec_add_ics",feed_url:a,feed_category:e("#ai1ec_feed_category option:selected").val(),feed_tags:e("#ai1ec_feed_tags").val(),comments_enabled:c,map_display_enabled:h};e.post(i,p,t.handle_add_new_ics,"json")}},o=function(n){n.preventDefault(),e("#ai1ec-ics-modal").modal("hide");var r=e(this).hasClass("remove")?!0:!1,s=e(this).data("el"),o=e(s),u=o.siblings(".ai1ec_feed_id").val();o.siblings(".ajax-loading").css("visibility","visible");var a={action:"ai1ec_delete_ics",ics_id:u,remove_events:r};e.post(i,a,t.handle_delete_ics,"json")},u=function(t){e("#ai1ec-ics-modal a.btn").data("el",this),e("#ai1ec-ics-modal").modal({show:!0,backdrop:!0})},a=function(n){var r=e(this);r.prop("disabled",!0);var s=r.siblings(".ai1ec_feed_id").val();r.siblings(".ajax-loading").css("visibility","visible");var o={action:"ai1ec_update_ics",ics_id:s};e.post(i,o,t.handle_update_ics,"json")};return{add_new_ics_event_handler:s,delete_ics_modal_handler:o,handle_open_modal:u,update_ics_handler:a}}),timely.define("scripts/calendar_feeds/file_upload/file_upload_event_handlers",["jquery","ai1ec_config"],function(e,t){var n=function(n){var r=e("#ai1ec_file_input").val(),i=e("#ai1ec_upload_textarea").val();if(r===""&&i==="")n.preventDefault(),alert(t.file_upload_required);else if(r!==""){var s=r.substr(r.length-4,4);s!==".ics"&&s!==".csv"&&(n.preventDefault(),alert(t.file_upload_not_permitted))}};return{handle_click_on_submit_file:n}}),timely.define("external_libs/bootstrap_alert",["jquery"],function(e){var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}),timely.define("external_libs/bootstrap_modal",["jquery"],function(e){var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}};var n=e.fn.modal;e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=n,this},e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}),timely.define("libs/modal_helper",["jquery","domReady","external_libs/bootstrap_modal"],function(e,t){t(function(){var t=e("body");t.on("shown",".modal",function(){t.addClass("ai1ec-modal-open")}).on("hidden",".modal",function(){t.removeClass("ai1ec-modal-open")})})}),timely.define("scripts/calendar_feeds",["jquery","domReady","scripts/calendar_feeds/facebook/facebook_event_handlers","scripts/calendar_feeds/facebook/facebook_utility_functions","scripts/calendar_feeds/ics/ics_event_handlers","scripts/calendar_feeds/file_upload/file_upload_event_handlers","external_libs/jquery_cookie","external_libs/bootstrap_tab","external_libs/bootstrap_alert","libs/modal_helper"],function(e,t,n,r,i,s){var o=function(){e("ul.nav-tabs a").click(n.handle_set_tab_cookie),e("#ai1ec_subscribe_users").click(n.do_controls_before_subscribing),e("input[type=submit]").not("#ai1ec_subscribe_users, #ai1ec_file_submit").click(n.handle_click_on_submit_buttons),e(".ai1ec-facebook-refresh-multiselect").click(n.refresh_multiselect),e(".ai1ec-facebook-items").on("click",".ai1ec-facebook-refresh",n.refresh_events),e(".ai1ec-facebook-items").on("click",".ai1ec-facebook-remove",n.remove_subscription),e("#ai1ec-facebook-modal").on("click","a.remove, a.keep",n.modal_remove_subscription),e("#ai1ec-facebook-connect a").click(n.click_on_facebook_connect_button_opens_modal_if_app_id_and_secret_are_not_set),e("body").on("click","#ai1ec_facebook_connect_modal a.keep",n.click_on_save_button_in_modal_trigger_submit),e("#ai1ec_add_new_ics").click(i.add_new_ics_event_handler),e("#ai1ec-ics-modal").on("click","a.remove, a.keep",i.delete_ics_modal_handler),e("div#ics").on("click",".ai1ec_delete_ics",i.handle_open_modal),e("div#ics").on("click",".ai1ec_update_ics",i.update_ics_handler),e("div#file_upload").on("click","#ai1ec_file_submit",s.handle_click_on_submit_file)},u=function(){t(function(){r.activate_saved_tab_on_page_load(e.cookie("feeds_active_tab")),o()})};return{start:u}});